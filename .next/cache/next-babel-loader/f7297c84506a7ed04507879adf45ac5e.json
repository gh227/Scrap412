{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\hero\\\\Documents\\\\projects\\\\Next\\\\pages\\\\signup.js\";\n\nvar __jsx = React.createElement;\nimport useCurrentUser from '../lib/hooks.js';\nimport nextConnect from 'next-connect';\nimport React, { useState, useEffect } from 'react';\nimport Head from '../components/head';\nimport Router from 'next/router';\nimport Link from 'next/link';\n\nvar Signup = function Signup() {\n  var _useState = useState(''),\n      errorMsg = _useState[0],\n      setErrorMsg = _useState[1];\n\n  var _useCurrentUser = useCurrentUser(),\n      _useCurrentUser2 = _slicedToArray(_useCurrentUser, 2),\n      user = _useCurrentUser2[0],\n      mutate = _useCurrentUser2[1].mutate;\n\n  useEffect(function () {\n    if (user) {\n      Router.replace('/');\n    }\n  }, [user]);\n\n  var handleSubmit = function handleSubmit(e) {\n    var body, res, userObj;\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            e.preventDefault();\n            body = {\n              name: e.currentTarget.name.value,\n              email: e.currentTarget.email.value,\n              password: e.currentTarget.password.value\n            };\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(fetch('api/users/', {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify(body)\n            }));\n\n          case 4:\n            res = _context.sent;\n\n            if (!(res.status === 201)) {\n              _context.next = 12;\n              break;\n            }\n\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(res.json());\n\n          case 8:\n            userObj = _context.sent;\n            mutate(userObj);\n            _context.next = 17;\n            break;\n\n          case 12:\n            _context.t0 = setErrorMsg;\n            _context.next = 15;\n            return _regeneratorRuntime.awrap(res.text());\n\n          case 15:\n            _context.t1 = _context.sent;\n            (0, _context.t0)(_context.t1);\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 5\n    }\n  }, __jsx(Head, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 9\n    }\n  }));\n};","map":{"version":3,"sources":["C:/Users/hero/Documents/projects/Next/pages/signup.js"],"names":["useCurrentUser","nextConnect","React","useState","useEffect","Head","Router","Link","Signup","errorMsg","setErrorMsg","user","mutate","replace","handleSubmit","e","preventDefault","body","name","currentTarget","value","email","password","fetch","method","headers","JSON","stringify","res","status","json","userObj","text"],"mappings":";;;;;;;AAAA,OAAOA,cAAP,MAA2B,iBAA3B;AACA,OAAOC,WAAP,MAAwB,cAAxB;AACA,OAAOC,KAAP,IAAeC,QAAf,EAAyBC,SAAzB,QAAyC,OAAzC;AACA,OAAOC,IAAP,MAAiB,oBAAjB;AAEA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,IAAP,MAAiB,WAAjB;;AAEA,IAAMC,MAAM,GAAE,SAARA,MAAQ,GAAI;AAAA,kBACcL,QAAQ,CAAC,EAAD,CADtB;AAAA,MACXM,QADW;AAAA,MACDC,WADC;;AAAA,wBAEOV,cAAc,EAFrB;AAAA;AAAA,MAEXW,IAFW;AAAA,MAEJC,MAFI,uBAEJA,MAFI;;AAGlBR,EAAAA,SAAS,CAAC,YAAI;AACV,QAAGO,IAAH,EAAQ;AACJL,MAAAA,MAAM,CAACO,OAAP,CAAe,GAAf;AACH;AACJ,GAJQ,EAIN,CAACF,IAAD,CAJM,CAAT;;AAMA,MAAMG,YAAY,GAAG,SAAfA,YAAe,CAAOC,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACjBA,YAAAA,CAAC,CAACC,cAAF;AACMC,YAAAA,IAFW,GAEJ;AACTC,cAAAA,IAAI,EAAEH,CAAC,CAACI,aAAF,CAAgBD,IAAhB,CAAqBE,KADlB;AAETC,cAAAA,KAAK,EAACN,CAAC,CAACI,aAAF,CAAgBE,KAAhB,CAAsBD,KAFnB;AAGTE,cAAAA,QAAQ,EAACP,CAAC,CAACI,aAAF,CAAgBG,QAAhB,CAAyBF;AAHzB,aAFI;AAAA;AAAA,6CAOCG,KAAK,CAAC,YAAD,EAAc;AACjCC,cAAAA,MAAM,EAAE,MADyB;AAEjCC,cAAAA,OAAO,EAAC;AAAC,gCAAe;AAAhB,eAFyB;AAGjCR,cAAAA,IAAI,EAACS,IAAI,CAACC,SAAL,CAAeV,IAAf;AAH4B,aAAd,CAPN;;AAAA;AAOXW,YAAAA,GAPW;;AAAA,kBAadA,GAAG,CAACC,MAAJ,KAAa,GAbC;AAAA;AAAA;AAAA;;AAAA;AAAA,6CAcSD,GAAG,CAACE,IAAJ,EAdT;;AAAA;AAcPC,YAAAA,OAdO;AAebnB,YAAAA,MAAM,CAACmB,OAAD,CAAN;AAfa;AAAA;;AAAA;AAAA,0BAkBbrB,WAlBa;AAAA;AAAA,6CAkBKkB,GAAG,CAACI,IAAJ,EAlBL;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAArB;;AAwBI,SACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CADA;AAKH,CAtCD","sourcesContent":["import useCurrentUser from '../lib/hooks.js'\r\nimport nextConnect from 'next-connect'\r\nimport React, {useState, useEffect} from 'react'\r\nimport Head from '../components/head'\r\n\r\nimport Router from 'next/router'\r\nimport Link from 'next/link'\r\n\r\nconst Signup= ()=>{\r\nconst [errorMsg, setErrorMsg] = useState('')\r\nconst [user, {mutate}] = useCurrentUser()\r\nuseEffect(()=>{\r\n    if(user){\r\n        Router.replace('/')\r\n    }\r\n}, [user])\r\n\r\nconst handleSubmit = async (e)=>{\r\n    e.preventDefault();\r\n    const body = {\r\n        name: e.currentTarget.name.value,\r\n        email:e.currentTarget.email.value,\r\n        password:e.currentTarget.password.value\r\n    }\r\n    const res = await fetch('api/users/',{\r\n        method: 'POST',\r\n        headers:{'Content-Type':'application/json'},\r\n        body:JSON.stringify(body),\r\n    });\r\n\r\n    if(res.status===201){\r\n        const userObj = await res.json();\r\n        mutate(userObj);\r\n    }\r\n    else{\r\n        setErrorMsg(await res.text());\r\n    }\r\n\r\n}\r\n\r\n\r\n    return(\r\n    <div>\r\n        <Head/>\r\n    </div>        \r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}