{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { MongoClient } from 'mongodb';\nimport nextConnect from 'next-connect';\nvar client = new MongoClient('mongodb://127.0.0.1:27017', {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\n\nfunction database(req, res, next) {\n  return _regeneratorRuntime.async(function database$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          if (client.isConnected()) {\n            _context.next = 3;\n            break;\n          }\n\n          _context.next = 3;\n          return _regeneratorRuntime.awrap(client.connect());\n\n        case 3:\n          req.dbClient = client;\n          req.db = client.db('loveConversation');\n          return _context.abrupt(\"return\", next());\n\n        case 6:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\n\nvar middleware = nextConnect();\nmiddleware.use(database);\nexport default middleware;","map":{"version":3,"sources":["C:/Users/hero/Documents/projects/Next/middleware/db.js"],"names":["MongoClient","nextConnect","client","useNewUrlParser","useUnifiedTopology","database","req","res","next","isConnected","connect","dbClient","db","middleware","use"],"mappings":";AAAA,SAASA,WAAT,QAA4B,SAA5B;AACA,OAAOC,WAAP,MAAwB,cAAxB;AAEA,IAAMC,MAAM,GAAG,IAAIF,WAAJ,CAAgB,2BAAhB,EAA6C;AAC1DG,EAAAA,eAAe,EAAE,IADyC;AAE1DC,EAAAA,kBAAkB,EAAE;AAFsC,CAA7C,CAAf;;AAKA,SAAeC,QAAf,CAAwBC,GAAxB,EAA6BC,GAA7B,EAAkCC,IAAlC;AAAA;AAAA;AAAA;AAAA;AAAA,cACON,MAAM,CAACO,WAAP,EADP;AAAA;AAAA;AAAA;;AAAA;AAAA,2CACmCP,MAAM,CAACQ,OAAP,EADnC;;AAAA;AAEEJ,UAAAA,GAAG,CAACK,QAAJ,GAAeT,MAAf;AACAI,UAAAA,GAAG,CAACM,EAAJ,GAASV,MAAM,CAACU,EAAP,CAAU,kBAAV,CAAT;AAHF,2CAISJ,IAAI,EAJb;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAOA,IAAMK,UAAU,GAAGZ,WAAW,EAA9B;AAEAY,UAAU,CAACC,GAAX,CAAeT,QAAf;AAEA,eAAeQ,UAAf","sourcesContent":["import { MongoClient } from 'mongodb';\r\nimport nextConnect from 'next-connect';\r\n\r\nconst client = new MongoClient('mongodb://127.0.0.1:27017', {\r\n  useNewUrlParser: true,\r\n  useUnifiedTopology: true,\r\n});\r\n\r\nasync function database(req, res, next) {\r\n  if (!client.isConnected()) await client.connect();\r\n  req.dbClient = client;\r\n  req.db = client.db('loveConversation');\r\n  return next();\r\n}\r\n\r\nconst middleware = nextConnect();\r\n\r\nmiddleware.use(database);\r\n\r\nexport default middleware;"]},"metadata":{},"sourceType":"module"}